<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  
    <title type="text" xml:lang="en">Sri R. Paladugu</title>
    <link type="application/atom+xml" rel="self" href="http://localhost:4000/atom.xml"/>
  
  <link href="http://localhost:4000/"/>
  <id>http://localhost:4000/</id>
  <updated>2017-02-26T08:58:05Z</updated>
  <author>
    <name>Sri Paladugu</name>
    <email>spaladug@gmail.com</email>
  </author>
  <rights type="text">Copyright © 2017 Sri Paladugu. All rights reserved.</rights>
  
  <entry>
  <title type="text">Pharmacotherapy IX</title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/Pharmacotherapy-IX.html" />
  <id>http://localhost:4000/Pharmacotherapy-IX</id>
  <published>2017-02-26T00:00:00Z</published>
  <updated>2017-02-26T00:00:00Z</updated>
  <content type="html"><![CDATA[ <p>*** Neuroanatomy Nomenclature</p>

<div class="highlighter-rouge"><pre class="highlight"><code>- Anterior/rostral: in the direction of nose/head
- Posterior/caudal: in the direction of rear, back
- Dorsal/superior: on top
- Ventral/inferior: on bottom
- Lateral: towards the outer part
- Medial: towards the inner part
- Sagittal: brain sectioned from rostral -&gt; caudal
- Coronal: brain sectioned from lateral left -&gt; lateral right
</code></pre>
</div>
 ]]></content>
</entry>


  <entry>
  <title type="text">Testing the limits of ggplot2's geom_boxplot</title>
  <link rel="alternate" type="text/html" href="http://localhost:4000/testing-the-limits-of-ggplot2s-geomboxplot.html" />
  <id>http://localhost:4000/testing-the-limits-of-ggplot2s-geomboxplot</id>
  <published>2014-03-25T03:03:04Z</published>
  <updated>2014-03-25T03:03:04Z</updated>
  <content type="html"><![CDATA[ <p>If you’re in the business of visualizing data, <a href="http://ggplot2.org">ggplot2</a> is great. There’s a bit of a learning curve, especially for those new to <a href="http://www.r-project.org/">R</a> – but it’s pretty redeeming when you finally master it and people actually <strong>want</strong> to look at your graphics. For aesthetics and consistency – but also partly out of pure stubbornness – I try to create all of my static plots with ggplot. This generally involves a lot of <a href="http://docs.ggplot2.org/current/">documentation</a>-consulting and <a href="http://stackoverflow.com/questions/tagged/ggplot2">stackoverflow</a>-searching, but luckily for me, the internet can usually provide at least one answer (if not ten) for most ggplot problems.</p>

<p>Recently, though, I ran up against an unexpected roadblock when attempting to make a fairly simple boxplot. Here’s the idea: a continuous measure on the y-axis, boxes with a color fill defined by a two-level factor, and a numerical but discrete and non-linearly-increasing measure of time on the x-axis. Here’s some simulated data to demonstrate:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">data.df</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="m">3</span><span class="p">,</span><span class="m">6</span><span class="p">,</span><span class="m">12</span><span class="p">,</span><span class="m">24</span><span class="p">,</span><span class="m">48</span><span class="p">),</span><span class="n">each</span><span class="o">=</span><span class="m">50</span><span class="p">),</span><span class="w">
    </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="m">300</span><span class="p">,</span><span class="w"> </span><span class="m">20</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">),</span><span class="w">
    </span><span class="n">measure</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="nf">rep</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"A"</span><span class="p">,</span><span class="s2">"B"</span><span class="p">),</span><span class="n">each</span><span class="o">=</span><span class="m">25</span><span class="p">),</span><span class="w"> </span><span class="m">6</span><span class="p">)))</span></code></pre></figure>

<p>My first approach was pretty much straight out of the <a href="http://docs.ggplot2.org/current/geom_boxplot.html">geom_boxplot docs</a>:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span><span class="w">
</span><span class="n">ggplot</span><span class="p">(</span><span class="n">data.df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">factor</span><span class="p">(</span><span class="n">time</span><span class="p">),</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">measure</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Time (time units)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Value (value units)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_fill_discrete</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Measure"</span><span class="p">)</span></code></pre></figure>

<p><img src="http://files.saraemoore.com/figures/2014-03-25-testing-the-limits-of-ggplot2s-geomboxplot-unnamed-chunk-2-1.png" title="plot of chunk unnamed-chunk-2" alt="plot of chunk unnamed-chunk-2" width="700px" height="500px" /></p>

<p>Of course, ggplot did exactly what I asked of it — it converted the “time” variable to a factor and placed each unique level on the plot without regard to how they were related numerically. OK, let’s try this again. We need the x-axis variable to remain numerical.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data.df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">measure</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Time (time units)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Value (value units)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_fill_discrete</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Measure"</span><span class="p">)</span></code></pre></figure>

<p><img src="http://files.saraemoore.com/figures/2014-03-25-testing-the-limits-of-ggplot2s-geomboxplot-unnamed-chunk-3-1.png" title="plot of chunk unnamed-chunk-3" alt="plot of chunk unnamed-chunk-3" width="700px" height="500px" /></p>

<p>Wrong again. Maybe ggplot can be tricked into re-grouping the boxes by the unique times on the x-axis?</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data.df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">time</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">value</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">fill</span><span class="o">=</span><span class="n">measure</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="o">=</span><span class="n">factor</span><span class="p">(</span><span class="n">time</span><span class="p">)))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Time (time units)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Value (value units)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_fill_discrete</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Measure"</span><span class="p">)</span></code></pre></figure>

<p><img src="http://files.saraemoore.com/figures/2014-03-25-testing-the-limits-of-ggplot2s-geomboxplot-unnamed-chunk-4-1.png" title="plot of chunk unnamed-chunk-4" alt="plot of chunk unnamed-chunk-4" width="700px" height="500px" /></p>

<p>Apparently not. In a last ditch effort, I found <a href="http://stackoverflow.com/questions/10805643/ggplot2-add-color-to-boxplot-continuous-value-supplied-to-discrete-scale-er">this SO post</a> which, while not answering my question directly, prompted <a href="http://stackoverflow.com/questions/10805643/ggplot2-add-color-to-boxplot-continuous-value-supplied-to-discrete-scale-er#comment14070382_10806683">an interesting comment</a>. Specifically, the commenter suggested adding a <code class="highlighter-rouge">position</code> aesthetic for a factor version of the x-axis variable. In terms of this running example, that would look like the following:</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data.df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="n">time</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">time</span><span class="p">),</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">measure</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Time (time units)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Value (value units)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_fill_discrete</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Measure"</span><span class="p">)</span></code></pre></figure>

<p><img src="http://files.saraemoore.com/figures/2014-03-25-testing-the-limits-of-ggplot2s-geomboxplot-unnamed-chunk-5-1.png" title="plot of chunk unnamed-chunk-5" alt="plot of chunk unnamed-chunk-5" width="700px" height="500px" /></p>

<p>It works. Below is a slightly improved code snippet, along with the (correct!) boxplot it produces.</p>

<figure class="highlight"><pre><code class="language-r" data-lang="r"><span class="n">ggplot</span><span class="p">(</span><span class="n">data.df</span><span class="p">,</span><span class="w"> </span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">value</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="o">=</span><span class="n">time</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">geom_boxplot</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factor</span><span class="p">(</span><span class="n">time</span><span class="p">),</span><span class="w"> </span><span class="n">fill</span><span class="o">=</span><span class="n">measure</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">data.df</span><span class="o">$</span><span class="n">time</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">xlab</span><span class="p">(</span><span class="s2">"Time (time units)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">ylab</span><span class="p">(</span><span class="s2">"Value (value units)"</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">
    </span><span class="n">scale_fill_discrete</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Measure"</span><span class="p">)</span></code></pre></figure>

<p><img src="http://files.saraemoore.com/figures/2014-03-25-testing-the-limits-of-ggplot2s-geomboxplot-unnamed-chunk-6-1.png" title="plot of chunk unnamed-chunk-6" alt="plot of chunk unnamed-chunk-6" width="700px" height="500px" /></p>

<p>(<strong>Update</strong> 22 Aug 2016: this post has been regenerated under ggplot2 v2.1.0 and edited for brevity.)</p>
 ]]></content>
</entry>



</feed>
